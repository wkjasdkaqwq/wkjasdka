<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Semi-rounded Corner - on Liuyanlin Community</title>
    <link rel="icon" href="/wkjasdka/index/echo logo.png" type="image/x-icon">
    <!-- 引入Font Awesome图标库 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
/* 九宫格按钮位置 */
.app-launcher-wrapper {
    position: relative;
    display: inline-block;
}
.app-launcher-container {
    position: relative;
    display: inline-block;
}
.app-launcher-group {
    display: flex;
    align-items: center;
    gap: 9px; /* 九宫格与 Logo 的距离 */
}
/* 九宫格按钮（透明背景） */
.app-launcher-btn {
    width: 40px;
    height: 40px;
    background: transparent;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}
/* 右侧 LOGO */
.app-launcher-logo img {
    height: 28px;   /* 可自行调整 */
    width: auto;
}
.app-launcher-logo span {
    font-size: 16px;
    font-weight: 600;
}
/* 下拉菜单 */
.app-launcher-menu {
    position: absolute;
    top: 50px;
    left: 0;
    width: 200px;
    display: none;
    flex-direction: column;
    background: #fff;
    border-radius: 10px;
    box-shadow: 0px 4px 20px rgba(0,0,0,0.15);
    padding: 10px;
}

/* 九宫格图标点 */
.grid-icon {
    display: grid;
    grid-template-columns: repeat(3, 4px);
    gap: 4px;
}
.grid-icon span {
    width: 4px;
    height: 4px;
    background: #555;
    border-radius: 50%;
}

.app-launcher-menu a {
    padding: 10px;
    border-radius: 6px;
    text-decoration: none;
    color: #333;
}
.app-launcher-menu a:hover {
    background: #efefef;
}

/* Logo样式 */
.navbar-logo {
    font-size: 1.5rem;
    font-weight: bold;
    text-decoration: none;
    color: #333;
    margin: 0;
    padding: 0;
    margin-left: 140px;
    cursor: pointer; /* 显示手型光标，提示可点击 */
    transition: color 0.3s;
}
.navbar-logo:hover { color: #666; }
.navbar-menu { display: flex; list-style: none; margin: 0; padding: 0 1rem; }
.navbar-item { margin-left: 2rem; }
.navbar-link { color: #333; text-decoration: none; transition: color 0.3s, transform 0.3s; font-weight: 500; }
.navbar-link:hover { color: #666; transform: translateY(-2px); }

/* 加载层样式：移除淡入淡出（不使用 opacity 过渡） */
.loading-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
}
.loading-logo {
    width: 300px;
    height: auto;
    display: none; /* 只有图片加载完成后才显示 */
}
.loading-text-container {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    text-align: center;
    padding: 0;
    display: none; /* 只有图片加载完成后才显示 */
}
.loading-text {
    color: #6a6a6a;
    font-size: 16px;
    margin: 5px 0;
}

/* 顶部加载条样式：允许 width 有平滑过渡，但开屏本身无淡入/淡出 */
.top-loading-bar {
    position: fixed;
    top: 0;
    left: 0;
    height: 5px;
    background-color: #ff8000;
    width: 0%;
    z-index: 10000;
    transition: width 0.15s linear;
}
    </style>
</head>

<body>
<div class="app-launcher-wrapper">
    <div class="app-launcher-group">
        <!-- 九宫格按钮 -->
        <button class="app-launcher-btn" id="appLauncherBtn" aria-label="应用菜单">
            <div class="grid-icon" aria-hidden="true">
                <span></span><span></span><span></span>
                <span></span><span></span><span></span>
                <span></span><span></span><span></span>
            </div>
        </button>

        <!-- 右侧 Logo（可用文字或图片） -->
        <div class="app-launcher-logo">
            <img src="index/community2.png" alt="Logo" />
        </div>
    </div>

    <!-- 下拉菜单 -->
    <div class="app-launcher-menu" id="appLauncherMenu" role="menu" aria-hidden="true">
        <a href="#">Liuyanlin Community</a>
        <a href="#">Liuyanlin Forum</a>
        <a href="#">Liuyanlin Social</a>
        <a href="#"></a>
        <a href="#"></a>
        <a href="#"></a>
    </div>
</div>

    <!-- 顶部加载条 -->
    <div class="top-loading-bar" id="topLoadingBar"></div>
    
    <div class="loading-screen" id="loadingScreen" aria-hidden="false">
        <img src="/wkjasdka/index/community2.png" alt="加载Logo" class="loading-logo" id="loadingLogo">
        <div class="loading-text-container" id="loadingTextContainer">
            <div class="loading-text">from</div>
            <div class="loading-text">- Wkjasdka -</div>
        </div>
    </div>

    <div id="mainContent" style="display: none;">
        <!-- 页面主内容放在这里 -->
    </div>

    <script>
        // ------- App launcher（九宫格）逻辑（去掉重复绑定） -------
        const btn = document.getElementById("appLauncherBtn");
        const menu = document.getElementById("appLauncherMenu");

        btn.addEventListener("click", (e) => {
            e.stopPropagation();
            const isOpen = menu.style.display === "flex";
            menu.style.display = isOpen ? "none" : "flex";
            menu.setAttribute('aria-hidden', isOpen ? 'true' : 'false');
        });

        // 点击空白处关闭
        document.addEventListener("click", (e) => {
            if (!btn.contains(e.target) && !menu.contains(e.target)) {
                menu.style.display = "none";
                menu.setAttribute('aria-hidden', 'true');
            }
        });

        // ------- Loading / progress 同步逻辑（无淡入淡出） -------
        const loadingBar = document.getElementById('topLoadingBar');
        const loadingLogo = document.getElementById('loadingLogo');
        const loadingTextContainer = document.getElementById('loadingTextContainer');
        const loadingScreen = document.getElementById('loadingScreen');
        const mainContent = document.getElementById('mainContent');

        let logoLoaded = false;
        let pageLoaded = false;
        let progress = 0;
        loadingBar.style.width = '0%';

        // 进度条定时器：模拟加载推进，但受 logo/page 状态控制
        const progressInterval = setInterval(() => {
            if (!logoLoaded) {
                // 等待 logo 下载时缓慢推进至 45%
                progress = Math.min(45, progress + (Math.random() * 1.2 + 0.2));
            } else if (!pageLoaded) {
                // logo 已加载，但页面未完全加载，推进到 90%（留出空间）
                progress = Math.min(90, progress + (Math.random() * 3 + 0.5));
            } else {
                // 页面加载完成：立即到 100（handleLoadComplete 会处理隐藏）
                progress = 100;
            }
            loadingBar.style.width = `${Math.floor(progress)}%`;
            if (progress >= 100) {
                clearInterval(progressInterval);
                // 延迟 0（即时）完成清理
                handleLoadComplete();
            }
        }, 100);

        // Logo 加载完成回调
        function onLogoLoaded() {
            if (logoLoaded) return;
            logoLoaded = true;
            // 立即显示 Logo 与文字（没有过渡）
            loadingLogo.style.display = 'block';
            loadingTextContainer.style.display = 'block';
            // 进度条立即至少跳到 50%
            progress = Math.max(progress, 50);
            loadingBar.style.width = `${Math.floor(progress)}%`;
        }

        // 页面完全加载回调
        function onPageLoaded() {
            if (pageLoaded) return;
            pageLoaded = true;
            // 进度条直接到 100%
            progress = 100;
            loadingBar.style.width = '100%';
            clearInterval(progressInterval);
            handleLoadComplete();
        }

        function handleLoadComplete() {
            // 立即隐藏加载屏并显示主内容（无淡入淡出）
            loadingScreen.style.display = 'none';
            loadingScreen.setAttribute('aria-hidden', 'true');
            mainContent.style.display = 'block';
            loadingBar.style.display = 'none';
        }

        // 监听 logo 图片：
        loadingLogo.addEventListener('load', onLogoLoaded);
        loadingLogo.addEventListener('error', () => {
            // 如果 logo 加载失败，也不要阻塞页面：把 logo 标记为已处理（显示占位文字）
            logoLoaded = true;
            loadingTextContainer.style.display = 'block';
            progress = Math.max(progress, 50);
            loadingBar.style.width = `${Math.floor(progress)}%`;
        });

        // 如果图片缓存导致 already complete，则立即触发
        if (loadingLogo.complete && loadingLogo.naturalWidth) {
            onLogoLoaded();
        }

        // 监听页面完全加载（所有资源）
        window.addEventListener('load', onPageLoaded);
        // 如果已在 complete 状态（脚本可能在 load 之后执行），立刻触发
        if (document.readyState === 'complete') {
            onPageLoaded();
        }
    </script>
</body>
</html>